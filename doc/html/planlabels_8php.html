<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>progetto201 API: www/html/api/options/planlabels.php File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">progetto201 API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5b91fe896655279d6afeb67d8a39e692.html">www</a></li><li class="navelem"><a class="el" href="dir_f7d3756803691839d6b25fb7b08f97b6.html">html</a></li><li class="navelem"><a class="el" href="dir_2588d0ba178b9f5c214f6d04d44e95ad.html">api</a></li><li class="navelem"><a class="el" href="dir_2fdc69c99285666f9fc8caf11731d2e1.html">options</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">planlabels.php File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><b>PLANLABELS</b>: manages plan's labels.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a63da149e1c19489a63a10defc5a47ef7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planlabels_8php.html#a63da149e1c19489a63a10defc5a47ef7">post_labels</a> ($t_conn_res)</td></tr>
<tr class="memdesc:a63da149e1c19489a63a10defc5a47ef7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts/removes label data to the database.  <a href="planlabels_8php.html#a63da149e1c19489a63a10defc5a47ef7">More...</a><br /></td></tr>
<tr class="separator:a63da149e1c19489a63a10defc5a47ef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a027284df6f647b1171c2f5fde15aa697"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planlabels_8php.html#a027284df6f647b1171c2f5fde15aa697">get_labels</a> ($t_conn_res)</td></tr>
<tr class="memdesc:a027284df6f647b1171c2f5fde15aa697"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns labels data.  <a href="planlabels_8php.html#a027284df6f647b1171c2f5fde15aa697">More...</a><br /></td></tr>
<tr class="separator:a027284df6f647b1171c2f5fde15aa697"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:af4b6fb1bbc77ccc05f10da3b16935b99"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="planlabels_8php.html#af4b6fb1bbc77ccc05f10da3b16935b99">$response</a> = array(&quot;errors&quot; =&gt; array())</td></tr>
<tr class="memdesc:af4b6fb1bbc77ccc05f10da3b16935b99"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare default response array with no errors.  <a href="planlabels_8php.html#af4b6fb1bbc77ccc05f10da3b16935b99">More...</a><br /></td></tr>
<tr class="separator:af4b6fb1bbc77ccc05f10da3b16935b99"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><b>PLANLABELS</b>: manages plan's labels. </p>
<p>Client perspective:</p><ul>
<li><b>GET</b> METHOD --&gt; returns labels data</li>
<li><b>POST</b> METHOD --&gt; add or removes a label</li>
</ul>
<h2><a class="anchor" id="autotoc_md17"></a>
Description</h2>
<p>This script sets the returned <b>content type to JSON</b>, <b>includes the <a class="el" href="db__connection_8php.html" title="DB_CONNECTION: manages database connection and queries.">db_connection.php</a> script</b> </p><blockquote class="doxtable">
<p>It is used to connect to MySQL and execute basic SELECT queries </p>
</blockquote>
<p>and then defines the response array.</p>
<p>Two functions are defined: </p><pre class="fragment"> post_labels()
</pre><p> Inserts/removes label data to the database. </p><pre class="fragment"> get_labels()
</pre><p> Returns labels data</p>
<p>If the script isn't included it tries to connect to the database, and checks the request method:</p><ul>
<li>if the method is GET it calls the <a class="el" href="planlabels_8php.html#a027284df6f647b1171c2f5fde15aa697" title="Returns labels data.">get_labels()</a> function</li>
<li>if the method is POST it calls the <a class="el" href="planlabels_8php.html#a63da149e1c19489a63a10defc5a47ef7" title="Inserts/removes label data to the database.">post_labels()</a> function</li>
</ul>
<p>When the called function ends the connection to the DB gets terminated, and data (or errors) is collected inside the response array. The response array gets echoed to the client in JSON format</p>
<p>Errors list:</p><ul>
<li><b>1100</b> - main: Method not supported by the target resource</li>
<li><b>1101</b> - main: No data but also No errors</li>
<li><b>1110</b> - <a class="el" href="planlabels_8php.html#a63da149e1c19489a63a10defc5a47ef7" title="Inserts/removes label data to the database.">post_labels()</a>: No rows affected (maybe the same values where sent?)</li>
<li><b>1111</b> - <a class="el" href="planlabels_8php.html#a63da149e1c19489a63a10defc5a47ef7" title="Inserts/removes label data to the database.">post_labels()</a>: Unable to execute INSERT/UPDATE query</li>
<li><b>1112</b> - <a class="el" href="planlabels_8php.html#a63da149e1c19489a63a10defc5a47ef7" title="Inserts/removes label data to the database.">post_labels()</a>: Couldn't remove the label, no rows affected</li>
<li><b>1113</b> - <a class="el" href="planlabels_8php.html#a63da149e1c19489a63a10defc5a47ef7" title="Inserts/removes label data to the database.">post_labels()</a>: Unable to execute DELETE query</li>
<li><b>1114</b> - <a class="el" href="planlabels_8php.html#a63da149e1c19489a63a10defc5a47ef7" title="Inserts/removes label data to the database.">post_labels()</a>: the required parameters are not set in the request</li>
<li><b>1115</b> - <a class="el" href="planlabels_8php.html#a63da149e1c19489a63a10defc5a47ef7" title="Inserts/removes label data to the database.">post_labels()</a>: There is an error in the SQL instruction</li>
<li><b>1120</b> - <a class="el" href="planlabels_8php.html#a027284df6f647b1171c2f5fde15aa697" title="Returns labels data.">get_labels()</a>: Error during query execution</li>
</ul>
<dl class="section since"><dt>Since</dt><dd>01_01 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Stefano Zenaro (<a href="https://github.com/mario33881">https://github.com/mario33881</a>) </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>MIT </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a027284df6f647b1171c2f5fde15aa697"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a027284df6f647b1171c2f5fde15aa697">&#9670;&nbsp;</a></span>get_labels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">get_labels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$t_conn_res</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns labels data. </p>
<p>The function executes a SELECT query to select the labels data.</p>
<dl class="section since"><dt>Since</dt><dd>01_01 </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$t_conn_res</td><td>array with the DB connection object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array $action_res array with errors or data </dd></dl>

</div>
</div>
<a id="a63da149e1c19489a63a10defc5a47ef7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63da149e1c19489a63a10defc5a47ef7">&#9670;&nbsp;</a></span>post_labels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">post_labels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$t_conn_res</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inserts/removes label data to the database. </p>
<p>The function checks if all the parameters have been passed inside the request.</p>
<p>Then it tries to insert the data and if the data is a duplicate, it updates the old data.</p>
<p>If the client sends only an id and a remove parameter, the function tries to remove the label from the table</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$t_conn_res</td><td>array with the DB connection object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array $action_res array with errors or data </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd><p class="startdd">should log the SQL error to a file... (should also log everything else) </p>
<p class="enddd">the "error" 1110 should be a warning </p>
</dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="af4b6fb1bbc77ccc05f10da3b16935b99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4b6fb1bbc77ccc05f10da3b16935b99">&#9670;&nbsp;</a></span>$response</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">$response = array(&quot;errors&quot; =&gt; array())</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare default response array with no errors. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
